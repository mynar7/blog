<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:125%/1.5 'Titillium Web',sans-serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'Titillium Web',sans-serif;font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:inherit;font-family:'Titillium Web',sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:inherit;font-family:'Titillium Web',sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:inherit;font-family:'Titillium Web',sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:inherit;font-family:'Titillium Web',sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:inherit;font-family:'Titillium Web',sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:inherit;font-family:'Titillium Web',sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}ul{margin-left:1.5rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.5rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;font-size:0.85rem;line-height:1.5rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;font-size:1rem;line-height:1.5rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}blockquote{margin-left:1.5rem;margin-right:1.5rem;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.5rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}b{font-weight:bold;}strong{font-weight:bold;}dt{font-weight:bold;}th{font-weight:bold;}li{margin-bottom:calc(1.5rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.5rem;margin-bottom:calc(1.5rem / 2);margin-top:calc(1.5rem / 2);}li > ul{margin-left:1.5rem;margin-bottom:calc(1.5rem / 2);margin-top:calc(1.5rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.5rem / 2);}code{font-size:0.85rem;line-height:1.5rem;}kbd{font-size:0.85rem;line-height:1.5rem;}samp{font-size:0.85rem;line-height:1.5rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1rem;padding-right:1rem;padding-top:0.75rem;padding-bottom:calc(0.75rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}</style><meta name="generator" content="Gatsby 5.0.1"/><meta name="theme-color" content="#496db1"/><meta data-react-helmet="true" name="author" content="Lee Warrick"/><meta data-react-helmet="true" name="description" content="If the React docs leave you in the dust, or Dan Abramov’s blog makes you feel like you’re reading a scroll handed down from Mt Olympus written in ancient Greek, you’re not alone.…"/><meta data-react-helmet="true" property="og:title" content="React&#x27;s useEffect and useRef Explained for Mortals"/><meta data-react-helmet="true" property="og:description" content="If the React docs leave you in the dust, or Dan Abramov’s blog makes you feel like you’re reading a scroll handed down from Mt Olympus written in ancient Greek, you’re not alone.…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:image" content="https://leewarrick.com/blog/react-use-effect-explained/twitter-card.jpg"/><meta data-react-helmet="true" name="twitter:image" content="https://leewarrick.com/blog/react-use-effect-explained/twitter-card.jpg"/><meta data-react-helmet="true" name="twitter:alt:image" content="Card with Author Portrait Logo Titled: React&#x27;s useEffect and useRef Explained for Mortals written by Lee Warrick on Strings and Things"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:creator" content="@leewarrickjr"/><meta data-react-helmet="true" name="twitter:site" content="@leewarrickjr"/><meta data-react-helmet="true" name="twitter:title" content="React&#x27;s useEffect and useRef Explained for Mortals"/><meta data-react-helmet="true" name="twitter:description" content="If the React docs leave you in the dust, or Dan Abramov’s blog makes you feel like you’re reading a scroll handed down from Mt Olympus written in ancient Greek, you’re not alone.…"/><meta data-react-helmet="true" name="keywords" content="blog, web development, developer, front-end developer"/><style data-href="/blog/styles.5878b01e3ecbd3d989a6.css" data-identity="gatsby-global-css">@font-face{font-display:swap;font-family:Titillium Web;font-style:normal;font-weight:200;src:local("Titillium Web Extra Light "),local("Titillium Web-Extra Light"),url(/blog/static/titillium-web-latin-200-c33bf599373d56a506fcc3b3ced84e09.woff2) format("woff2"),url(/blog/static/titillium-web-latin-200-029933c6d5c0dc0292c81526a4189e40.woff) format("woff")}@font-face{font-display:swap;font-family:Titillium Web;font-style:italic;font-weight:200;src:local("Titillium Web Extra Light italic"),local("Titillium Web-Extra Lightitalic"),url(/blog/static/titillium-web-latin-200italic-1e3c0e268daa3802884f49b8dce4a7de.woff2) format("woff2"),url(/blog/static/titillium-web-latin-200italic-bce5018771b63c0d5022d5769dbce72c.woff) format("woff")}@font-face{font-display:swap;font-family:Titillium Web;font-style:normal;font-weight:300;src:local("Titillium Web Light "),local("Titillium Web-Light"),url(/blog/static/titillium-web-latin-300-a9f15c03c7be417ca392ae8b3cfd2932.woff2) format("woff2"),url(/blog/static/titillium-web-latin-300-3a895a322913a0ef145a837ab62f40a7.woff) format("woff")}@font-face{font-display:swap;font-family:Titillium Web;font-style:italic;font-weight:300;src:local("Titillium Web Light italic"),local("Titillium Web-Lightitalic"),url(/blog/static/titillium-web-latin-300italic-8ad3a36580b69e6904388ece2109a611.woff2) format("woff2"),url(/blog/static/titillium-web-latin-300italic-3e12ca52140781be1fbd2a0045deef15.woff) format("woff")}@font-face{font-display:swap;font-family:Titillium Web;font-style:normal;font-weight:400;src:local("Titillium Web Regular "),local("Titillium Web-Regular"),url(/blog/static/titillium-web-latin-400-475030ab25f65239c7cfc30617134366.woff2) format("woff2"),url(/blog/static/titillium-web-latin-400-b1511d6bc1dbcc87e1bb42df30f4bb6b.woff) format("woff")}@font-face{font-display:swap;font-family:Titillium Web;font-style:italic;font-weight:400;src:local("Titillium Web Regular italic"),local("Titillium Web-Regularitalic"),url(/blog/static/titillium-web-latin-400italic-4b0397c024255e6dd29d2f453daba028.woff2) format("woff2"),url(/blog/static/titillium-web-latin-400italic-ccc64f345dcd38cde5c0e3e5273eb616.woff) format("woff")}@font-face{font-display:swap;font-family:Titillium Web;font-style:normal;font-weight:600;src:local("Titillium Web SemiBold "),local("Titillium Web-SemiBold"),url(/blog/static/titillium-web-latin-600-943efce0bc51c0480d3ae05ae1c00eed.woff2) format("woff2"),url(/blog/static/titillium-web-latin-600-fc27fa5ab064bb2fe5325a5778b81f5d.woff) format("woff")}@font-face{font-display:swap;font-family:Titillium Web;font-style:italic;font-weight:600;src:local("Titillium Web SemiBold italic"),local("Titillium Web-SemiBolditalic"),url(/blog/static/titillium-web-latin-600italic-3761b5188e0376e20299e182dc5dba5f.woff2) format("woff2"),url(/blog/static/titillium-web-latin-600italic-7ee4b2512d967c31ddc975d1ecb23181.woff) format("woff")}@font-face{font-display:swap;font-family:Titillium Web;font-style:normal;font-weight:700;src:local("Titillium Web Bold "),local("Titillium Web-Bold"),url(/blog/static/titillium-web-latin-700-fd3c62efe08bd8f3a3dc982ce8471c53.woff2) format("woff2"),url(/blog/static/titillium-web-latin-700-b6c7f5d3817a53e40a695b54a6c20780.woff) format("woff")}@font-face{font-display:swap;font-family:Titillium Web;font-style:italic;font-weight:700;src:local("Titillium Web Bold italic"),local("Titillium Web-Bolditalic"),url(/blog/static/titillium-web-latin-700italic-6eb4efeb3c35c9cb2cc8219a83ebccc2.woff2) format("woff2"),url(/blog/static/titillium-web-latin-700italic-4bed85ee401bc32dccf9399c62e8e25b.woff) format("woff")}@font-face{font-display:swap;font-family:Titillium Web;font-style:normal;font-weight:900;src:local("Titillium Web Black "),local("Titillium Web-Black"),url(/blog/static/titillium-web-latin-900-a0f449508df54bcf1a39897fb2baaf2c.woff2) format("woff2"),url(/blog/static/titillium-web-latin-900-27ff8b105040af0067a5e93199eef2fa.woff) format("woff")}:root{--primary:#496db1;--primaryFaded:rgba(73,109,177,.2);--gray:#505050;--grayLight:#969696;--white:#fafafa;--red:#bf2a2a;--dark-white:#cbc7c0;--dark-primary:#1a1b1c}body{background-color:var(--white);background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='56' height='28' viewBox='0 0 56 28'%3E%3Cpath fill='%235C5C5CBB' fill-opacity='.4' d='M56 26v2h-7.75c2.3-1.27 4.94-2 7.75-2zm-26 2a2 2 0 1 0-4 0h-4.09A25.98 25.98 0 0 0 0 16v-2c.67 0 1.34.02 2 .07V14a2 2 0 0 0-2-2v-2a4 4 0 0 1 3.98 3.6 28.09 28.09 0 0 1 2.8-3.86A8 8 0 0 0 0 6V4a9.99 9.99 0 0 1 8.17 4.23c.94-.95 1.96-1.83 3.03-2.63A13.98 13.98 0 0 0 0 0h7.75c2 1.1 3.73 2.63 5.1 4.45 1.12-.72 2.3-1.37 3.53-1.93A20.1 20.1 0 0 0 14.28 0h2.7c.45.56.88 1.14 1.29 1.74 1.3-.48 2.63-.87 4-1.15-.11-.2-.23-.4-.36-.59H26v.07a28.4 28.4 0 0 1 4 0V0h4.09l-.37.59c1.38.28 2.72.67 4.01 1.15.4-.6.84-1.18 1.3-1.74h2.69a20.1 20.1 0 0 0-2.1 2.52c1.23.56 2.41 1.2 3.54 1.93A16.08 16.08 0 0 1 48.25 0H56c-4.58 0-8.65 2.2-11.2 5.6 1.07.8 2.09 1.68 3.03 2.63A9.99 9.99 0 0 1 56 4v2a8 8 0 0 0-6.77 3.74c1.03 1.2 1.97 2.5 2.79 3.86A4 4 0 0 1 56 10v2a2 2 0 0 0-2 2.07 28.4 28.4 0 0 1 2-.07v2c-9.2 0-17.3 4.78-21.91 12H30zM7.75 28H0v-2c2.81 0 5.46.73 7.75 2zM56 20v2c-5.6 0-10.65 2.3-14.28 6h-2.7c4.04-4.89 10.15-8 16.98-8zm-39.03 8h-2.69C10.65 24.3 5.6 22 0 22v-2c6.83 0 12.94 3.11 16.97 8zm15.01-.4a28.09 28.09 0 0 1 2.8-3.86 8 8 0 0 0-13.55 0c1.03 1.2 1.97 2.5 2.79 3.86a4 4 0 0 1 7.96 0zm14.29-11.86c1.3-.48 2.63-.87 4-1.15a25.99 25.99 0 0 0-44.55 0c1.38.28 2.72.67 4.01 1.15a21.98 21.98 0 0 1 36.54 0zm-5.43 2.71c1.13-.72 2.3-1.37 3.54-1.93a19.98 19.98 0 0 0-32.76 0c1.23.56 2.41 1.2 3.54 1.93a15.98 15.98 0 0 1 25.68 0zm-4.67 3.78c.94-.95 1.96-1.83 3.03-2.63a13.98 13.98 0 0 0-22.4 0c1.07.8 2.09 1.68 3.03 2.63a9.99 9.99 0 0 1 16.34 0z'/%3E%3C/svg%3E");color:var(--gray);display:flex;flex-direction:column;justify-content:center;min-height:100vh;padding:32px 0;position:relative;transition:color .5s,background-color .5s}.banners:before{background-blend-mode:overlay;background-color:var(--primary);background-image:url(/blog/static/Lee-a231fdb2788fb94f18bd3ce50f285ac4.png);background-position-x:35px;background-position-y:0;background-repeat:no-repeat;background-size:250px;-webkit-clip-path:polygon(0 0,100% 0,100% 70%,0 100%);clip-path:polygon(0 0,100% 0,100% 70%,0 100%);height:40vh;top:0;z-index:-1}.banners:after,.banners:before{content:"";left:0;position:absolute;width:100%}.banners:after{background:var(--primary);bottom:0;-webkit-clip-path:polygon(0 60%,100% 0,100% 100%,0 100%);clip-path:polygon(0 60%,100% 0,100% 100%,0 100%);height:20vh;z-index:-2}.wrapper{background-color:var(--white);box-shadow:2px 4px 3px var(--gray);margin:auto;max-width:960px;padding:48px}a{box-shadow:0 -10px 0 0 var(--primaryFaded) inset;color:inherit;position:relative;text-decoration:none;transition:color .2s,box-shadow .2s}a:hover{box-shadow:0 -2px 0 0 var(--primary) inset;color:var(--primary)}a.gatsby-resp-image-link{box-shadow:none}blockquote{font-style:italic;position:relative}blockquote:after{background-color:var(--gray);content:"";height:100%;left:-70px;position:absolute;top:0;width:3px}code{color:var(--red)}textarea{outline:none}@media screen and (max-width:865px){body{padding:0}body:after,body:before{display:none}}@media screen and (max-width:500px){.wrapper{padding:24px 6px}}</style><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" title="Strings and Things" href="/blog/rss.xml"/><link rel="icon" href="/blog/favicon-32x32.png?v=9fe7e1fe3a7415c8c36797f16a045178" type="image/png"/><link rel="manifest" href="/blog/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/blog/icons/icon-48x48.png?v=9fe7e1fe3a7415c8c36797f16a045178"/><link rel="apple-touch-icon" sizes="72x72" href="/blog/icons/icon-72x72.png?v=9fe7e1fe3a7415c8c36797f16a045178"/><link rel="apple-touch-icon" sizes="96x96" href="/blog/icons/icon-96x96.png?v=9fe7e1fe3a7415c8c36797f16a045178"/><link rel="apple-touch-icon" sizes="144x144" href="/blog/icons/icon-144x144.png?v=9fe7e1fe3a7415c8c36797f16a045178"/><link rel="apple-touch-icon" sizes="192x192" href="/blog/icons/icon-192x192.png?v=9fe7e1fe3a7415c8c36797f16a045178"/><link rel="apple-touch-icon" sizes="256x256" href="/blog/icons/icon-256x256.png?v=9fe7e1fe3a7415c8c36797f16a045178"/><link rel="apple-touch-icon" sizes="384x384" href="/blog/icons/icon-384x384.png?v=9fe7e1fe3a7415c8c36797f16a045178"/><link rel="apple-touch-icon" sizes="512x512" href="/blog/icons/icon-512x512.png?v=9fe7e1fe3a7415c8c36797f16a045178"/><title data-react-helmet="true">React&#x27;s useEffect and useRef Explained for Mortals | Strings and Things</title></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="wrapper"><div style="display:flex;justify-content:space-between;align-items:flex-start"><h3 style="margin-top:0;margin-bottom:-1.5rem"><a href="/blog/">Strings and Things</a></h3><span style="color:var(--white);cursor:pointer">🌙</span></div><h1 style="margin-top:3.75rem">React&#x27;s useEffect and useRef Explained for Mortals</h1><p style="font-size:0.87055rem;line-height:1.5rem;display:block;margin-bottom:1.5rem;margin-top:-1.5rem">September 06, 2019</p><div><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/blog/static/fdb92914fc9093dee6a2c20dad8fbd50/e5166/acropolis.jpg"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 66.89189189189189%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAABQACBP/EABYBAQEBAAAAAAAAAAAAAAAAAAIAAf/aAAwDAQACEAMQAAABW5zNlIx9Z//EABoQAAIDAQEAAAAAAAAAAAAAAAECERITAAP/2gAIAQEAAQUC0UFvcchuuhJm6Kxj/8QAFhEBAQEAAAAAAAAAAAAAAAAAABES/9oACAEDAQE/AYy//8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8Bqv/EAB0QAAICAQUAAAAAAAAAAAAAAAABETESAiFBUaH/2gAIAQEABj8Cx5K9MoRpfbE4poia2P/EABsQAQEBAAIDAAAAAAAAAAAAAAERACExQXGB/9oACAEBAAE/IexMeJicAbwWLuuHpuOllbNKcP0bijBOf//aAAwDAQACAAMAAAAQVD//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAwEBPxCVP//EABYRAQEBAAAAAAAAAAAAAAAAAAABEf/aAAgBAgEBPxC0y//EAB4QAQEAAQMFAAAAAAAAAAAAAAERAFGRoSExYXGB/9oACAEBAAE/EFVQhQnzjUIhBp6cY1SwIk1sy6aFL5NsQgeUe4Xrzg2JRNBQ4m2f/9k='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Photo of the Acropolis of Athens, Athens, Greece by Cristina Gottardi"
        title="Photo of the Acropolis of Athens, Athens, Greece by Cristina Gottardi"
        src="/blog/static/fdb92914fc9093dee6a2c20dad8fbd50/1c72d/acropolis.jpg"
        srcset="/blog/static/fdb92914fc9093dee6a2c20dad8fbd50/a80bd/acropolis.jpg 148w,
/blog/static/fdb92914fc9093dee6a2c20dad8fbd50/1c91a/acropolis.jpg 295w,
/blog/static/fdb92914fc9093dee6a2c20dad8fbd50/1c72d/acropolis.jpg 590w,
/blog/static/fdb92914fc9093dee6a2c20dad8fbd50/a8a14/acropolis.jpg 885w,
/blog/static/fdb92914fc9093dee6a2c20dad8fbd50/fbd2c/acropolis.jpg 1180w,
/blog/static/fdb92914fc9093dee6a2c20dad8fbd50/e5166/acropolis.jpg 1200w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></div>
<p>If the React docs leave you in the dust, or Dan Abramov’s <a href="https://overreacted.io/a-complete-guide-to-useeffect/">blog</a> makes you feel like you’re reading a scroll handed down from Mt Olympus written in ancient Greek, you’re not alone.</p>
<p>Sometimes the pantheon of React Gods have a hard time translating their wisdom into language the rest of us can understand. It usually goes like this: You hit a snag with React, google your issue, and read a blog or Stack Overflow post with some advice that makes you feel more lost than when you started.</p>
<p>I’ve certainly fallen victim to this many, many times. Particularly with <code>useEffect</code>. Before we dive into this particular hook, let me say that I love writing React with hooks and wouldn’t want to go back to classes. That said, <code>useEffect</code> is a big pain point.</p>
<h2>What is an “effect” anyway?</h2>
<p>To really wrap your head around <code>useEffect</code>, let’s back up a little bit and talk about programming and JavaScript.</p>
<p>The effects that <code>useEffect</code> is named for are what we affectionately refer to as “side effects”.</p>
<p>So what is a side effect? It’s a bit of code that reaches out and …does something else. It’s an abstract concept, so let’s talk in examples.</p>
<p>Here’s a function with NO side effects:</p>
<div style="margin-bottom:3rem"><pre style="margin:0;font-size:0.75rem;line-height:1.125rem;color:var(--grayLight);white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word">JavaScript<!-- --> Snippet:</pre><pre class="prism-code language-js" style="background-color:#282c34;color:#ffffff;overflow-x:auto;padding:10px;font-size:0.8rem;line-height:inherit"><div class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">add</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token parameter">a</span><span class="token parameter punctuation" style="color:#8dc891">,</span><span class="token parameter"> b</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> a </span><span class="token operator" style="color:#d7deea">+</span><span class="token plain"> b</span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span></div></pre></div>
<p>The function <code>add</code> does nothing except take an input and return an output. It doesn’t reach outside itself to mess with anything else!</p>
<p>Let’s introduce a side effect.</p>
<div style="margin-bottom:3rem"><pre style="margin:0;font-size:0.75rem;line-height:1.125rem;color:var(--grayLight);white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word">Live<!-- --> <!-- -->JavaScript<!-- --> Snippet:</pre><pre class="prism-code language-js" style="background-color:#282c34;color:#ffffff;overflow-x:auto;padding:10px;font-size:0.8rem;line-height:inherit"><div class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> resultDiv </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#d7deea">document</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">getElementById</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&#x27;add-example&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">add</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token parameter">a</span><span class="token parameter punctuation" style="color:#8dc891">,</span><span class="token parameter"> b</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> result </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> a </span><span class="token operator" style="color:#d7deea">+</span><span class="token plain"> b</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    resultDiv</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">textContent</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#8dc891">`</span><span class="token template-string string" style="color:#8dc891">The Result is </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#8dc891">${</span><span class="token template-string interpolation">result</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#8dc891">}</span><span class="token template-string template-punctuation string" style="color:#8dc891">`</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> a </span><span class="token operator" style="color:#d7deea">+</span><span class="token plain"> b</span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token function" style="color:#79b6f2">add</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">3</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">4</span><span class="token punctuation" style="color:#8dc891">)</span></div></pre></div>
<div style="margin-bottom:3rem"><pre style="margin:0;font-size:0.75rem;line-height:1.125rem;color:var(--grayLight);white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word">Live<!-- --> <!-- -->HTML<!-- --> Snippet:</pre><pre class="prism-code language-html" style="background-color:#282c34;color:#ffffff;overflow-x:auto;padding:10px;font-size:0.8rem;line-height:inherit"><div class="token-line" style="color:#ffffff"><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#8dc891">=</span><span class="token tag attr-value punctuation" style="color:#8dc891">&quot;</span><span class="token tag attr-value" style="color:#8dc891">add-example</span><span class="token tag attr-value punctuation" style="color:#8dc891">&quot;</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span></div></pre><pre style="margin:0;margin-top:0.75rem;font-size:0.75rem;line-height:1.125rem;color:var(--grayLight)">Rendered HTML:</pre><div style="color:var(--gray);background:var(--white)"><div id="add-example"></div></div></div>
<p>Now our function reaches outside of itself to update the DOM (short for <a href="https://www.youtube.com/watch?v=H63dVFDuJDM">Document Object Model</a>) and show the result. This additional behavior is a side effect.</p>
<h2>Side Effects in React</h2>
<p>So what about React? It’s a library that pretty much only updates the DOM. A view library, if you will. So what would you call a side effect in React?</p>
<p>Anything outside of updating the page. If you’re not using React to update state or render HTML, that’s a side effect. It’s any non-React thing.</p>
<p>This means anytime you call an API, use <code>setInterval</code>/<code>setTimeout</code>, add a keyboard listener, or really anytime you mess with the <code>window</code> object you’re introducing side effects.</p>
<p>Hooks are amazing and let you write really readable, reusable code… except when you’re dealing with side effects. And that’s unfortunate, because when you think about it, most of the fun, interesting stuff we do as web developers revolves around side effects.</p>
<p>Let’s take a step back from hooks for a minute and look at how we would handle side effects in class-based components.</p>
<h3>Class-based Components and Side Effects</h3>
<p>In class-based components, we would use lifecycle methods to perform side effects. For example, on <code>componentDidMount</code> we would call APIs to get data for render.</p>
<p><em>“Why not call the API in the constructor function?”</em>, you might ask. Well, because React says stuff we use for render goes in “state” and we can’t mess with state until our component is loaded onto the page. If we try to update state before the component is loaded, we get errors.</p>
<p>Here’s a typical class-based component hitting the <a href="https://pokeapi.co/">PokeAPI</a>:</p>
<div style="margin-bottom:3rem"><pre style="margin:0;font-size:0.75rem;line-height:1.125rem;color:var(--grayLight);white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word">Live<!-- --> <!-- -->JSX<!-- --> Snippet:</pre><pre class="prism-code language-jsx" style="background-color:#282c34;color:#ffffff;overflow-x:auto;padding:10px;font-size:0.8rem;line-height:inherit"><div class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">class</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">Pokemon</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">extends</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">React</span><span class="token class-name punctuation" style="color:#8dc891">.</span><span class="token class-name" style="color:#FAC863">Component</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token function" style="color:#79b6f2">constructor</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">super</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">this</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">state</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#c5a5c5">null</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token function" style="color:#79b6f2">componentDidMount</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token function" style="color:#79b6f2">fetch</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&#x27;https://pokeapi.co/api/v2/pokemon/gengar/&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">then</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token parameter">res</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> res</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">json</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">then</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token parameter">res</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token keyword" style="color:#c5a5c5">this</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">setState</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">res</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token function" style="color:#79b6f2">render</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> pokemon </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">this</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">state</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> style </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token literal-property property" style="color:#5a9bcf">textTransform</span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;capitalize&#x27;</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">            </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"> pokemon</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token operator" style="color:#d7deea">?</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">                    </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">img</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">src</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#8dc891">=</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">{</span><span class="token tag script language-javascript" style="color:#fc929e">pokemon</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">.</span><span class="token tag script language-javascript property-access" style="color:#fc929e">sprites</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">.</span><span class="token tag script language-javascript property-access" style="color:#fc929e">front_default</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">}</span><span class="token tag" style="color:#fc929e"></span></div><div class="token-line" style="color:#ffffff"><span class="token tag" style="color:#fc929e">                        </span><span class="token tag attr-name" style="color:#c5a5c5">alt</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#8dc891">=</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">{</span><span class="token tag script language-javascript string" style="color:#8dc891">&#x27;Image of &#x27;</span><span class="token tag script language-javascript" style="color:#fc929e"> </span><span class="token tag script language-javascript operator" style="color:#d7deea">+</span><span class="token tag script language-javascript" style="color:#fc929e"> pokemon</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">.</span><span class="token tag script language-javascript property-access" style="color:#fc929e">name</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">/&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">                    </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">style</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#8dc891">=</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">{</span><span class="token tag script language-javascript" style="color:#fc929e">style</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text">Name: </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">pokemon</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">                    </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">style</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#8dc891">=</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">{</span><span class="token tag script language-javascript" style="color:#fc929e">style</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">                        Type: </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">pokemon</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">types</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">map</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token parameter">x</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> x</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">type</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">join</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&#x27;, &#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">                    </span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">                </span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;Loading...&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span></div></pre></div>
<p>This works well, except when it doesn’t. What happens when we want to hit the API again to grab a different pokemon? What if this component is attached to a certain route in our app and the route changes, but the component doesn’t unmount/remount. What if the user goes to a different page and the component unmounts before the API call finishes?</p>
<p>The answer is to add more lifecycle methods like <code>componentDidUpdate</code> and <code>componentWillUnmount</code> to perform more API calls and prevent weird unmounting errors. So we add those lifecycle methods in to handle all our edge cases. And by the time we’re done, we realize most of our component consists of lifecycle code.</p>
<h2>Then Came React Hooks</h2>
<p>The React team realized that the class API is a little unwieldy and hard to reason about. People were making <a href="https://levelup.gitconnected.com/componentdidmakesense-react-lifecycle-explanation-393dcb19e459">lifecycle flowcharts</a> trying to understand the inner workings of React …it was a mess.</p>
<p>So at ReactConf in October of 2018, after Sophie Alpert outlined just how bad classes are to use, Dan Abramov got on stage and introduced hooks (You can watch the video <a href="https://youtu.be/dpw9EHDh2bM?t=643">here</a>).</p>
<p>Hooks introduced statefulness in functional components, as well as a new way to handle side effects. Hooks made React code more reusable with less code—a huge win!</p>
<p>Except for one small quirk. Each render, the whole component/function is re-run.</p>
<p>Let’s look at an example of a hooks-based component:</p>
<div style="margin-bottom:3rem"><pre style="margin:0;font-size:0.75rem;line-height:1.125rem;color:var(--grayLight);white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word">Live<!-- --> <!-- -->JSX<!-- --> Snippet:</pre><pre class="prism-code language-jsx" style="background-color:#282c34;color:#ffffff;overflow-x:auto;padding:10px;font-size:0.8rem;line-height:inherit"><div class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#79b6f2">RerenderExample</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain">bool</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> setBool</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useState</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token boolean" style="color:#ff8b50">false</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> randomNum </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:#FAC863">Math</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">random</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text">This number will be different each time you click the button:</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">randomNum</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">button</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#8dc891">=</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">{</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">(</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">)</span><span class="token tag script language-javascript" style="color:#fc929e"> </span><span class="token tag script language-javascript arrow operator" style="color:#d7deea">=&gt;</span><span class="token tag script language-javascript" style="color:#fc929e"> </span><span class="token tag script language-javascript function" style="color:#79b6f2">setBool</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">(</span><span class="token tag script language-javascript operator" style="color:#d7deea">!</span><span class="token tag script language-javascript" style="color:#fc929e">bool</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">)</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text">Trigger a render</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">button</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span></div></pre></div>
<p>We’re not even using <code>bool</code> in our rendered JSX, yet the whole function runs everytime the state changes. <strong>Every render, everything inside the component re-runs: function definitions, variable creation/assignment, etc.</strong></p>
<p>If you’re thinking <em>“what if I have to do something computationally expensive inside a component? This can’t be performant…”</em>, that’s an astute observation. An expensive operation in a functional component <em>wouldn’t</em> be performant. In fact <code>useCallback</code> and <code>useMemo</code> exist as escape hatches for this very problem. Kent C Dodds has a challenging read on those <a href="https://kentcdodds.com/blog/usememo-and-usecallback">here</a>, but to summarize, according to Kent you shouldn’t worry about the re-renders until you see performance impacts.</p>
<p>(<strong>Note</strong>: If you’re unfamiliar with hooks, bookmark that article and come back to it when you’re ready. Don’t worry about memoization until you have to.)</p>
<p>Hooks like <code>useState</code> employ some magic under-the-hood to avoid the re-render problem. That’s great, and it seems simple enough using <code>useState</code>, but what about when you need to do things outside of setting state?</p>
<p>Enter <code>useEffect</code>. Gone are those pesky lifecycle methods, hooray! However this hook comes with its own weirdness. First let’s check out the syntax:</p>
<div style="margin-bottom:3rem"><pre style="margin:0;font-size:0.75rem;line-height:1.125rem;color:var(--grayLight);white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word">JSX<!-- --> Snippet:</pre><pre class="prism-code language-jsx" style="background-color:#282c34;color:#ffffff;overflow-x:auto;padding:10px;font-size:0.8rem;line-height:inherit"><div class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">//accepts two arguments: a function, and dependency array</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token function" style="color:#79b6f2">useEffect</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token comment" style="color:#999999">// do stuff</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"> </span><span class="token comment" style="color:#999999">//function to undo our stuff from above when component unmounts</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token comment" style="color:#999999">//dependency array of things to watch for changes on</span></div></pre></div>
<p>So you pass <code>useEffect</code> a callback function to run that contains your side effects, and then an array of things to watch. If the watched things change, <code>useEffect</code> will re-run our callback function. If you need to clean up your side effect on unmount, return a function that contains that code.</p>
<p>Let’s look at our pokemon example with hooks and <code>useEffect</code>:</p>
<div style="margin-bottom:3rem"><pre style="margin:0;font-size:0.75rem;line-height:1.125rem;color:var(--grayLight);white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word">Live<!-- --> <!-- -->JSX<!-- --> Snippet:</pre><pre class="prism-code language-jsx" style="background-color:#282c34;color:#ffffff;overflow-x:auto;padding:10px;font-size:0.8rem;line-height:inherit"><div class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#79b6f2">Pokemon</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain">pokemon</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> setPokemon</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useState</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword null nil" style="color:#c5a5c5">null</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useEffect</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token function" style="color:#79b6f2">fetch</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&#x27;https://pokeapi.co/api/v2/pokemon/gengar/&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">then</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token parameter">res</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> res</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">json</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">then</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token parameter">res</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token function" style="color:#79b6f2">setPokemon</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">res</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token comment" style="color:#999999">// empty array means nothing to watch, so run once and no more</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> style </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token literal-property property" style="color:#5a9bcf">textTransform</span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;capitalize&#x27;</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">        </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"> pokemon</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token operator" style="color:#d7deea">?</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">                </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">img</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">src</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#8dc891">=</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">{</span><span class="token tag script language-javascript" style="color:#fc929e">pokemon</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">.</span><span class="token tag script language-javascript property-access" style="color:#fc929e">sprites</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">.</span><span class="token tag script language-javascript property-access" style="color:#fc929e">front_default</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">}</span><span class="token tag" style="color:#fc929e"></span></div><div class="token-line" style="color:#ffffff"><span class="token tag" style="color:#fc929e">                    </span><span class="token tag attr-name" style="color:#c5a5c5">alt</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#8dc891">=</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">{</span><span class="token tag script language-javascript string" style="color:#8dc891">&#x27;Image of &#x27;</span><span class="token tag script language-javascript" style="color:#fc929e"> </span><span class="token tag script language-javascript operator" style="color:#d7deea">+</span><span class="token tag script language-javascript" style="color:#fc929e"> pokemon</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">.</span><span class="token tag script language-javascript property-access" style="color:#fc929e">name</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">/&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">                </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">style</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#8dc891">=</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">{</span><span class="token tag script language-javascript" style="color:#fc929e">style</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text">Name: </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">pokemon</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">                </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">style</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#8dc891">=</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">{</span><span class="token tag script language-javascript" style="color:#fc929e">style</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">                    Type: </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">pokemon</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">types</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">map</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token parameter">x</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> x</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">type</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">join</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&#x27;, &#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">                </span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;Loading...&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span></div></pre></div>
<p>If you’re staring at that empty dependency array, you’ve noticed the first <code>useEffect</code> quirk. By passing an empty array, we’re saying “only ever do this once”. The React pantheon tells us that on rare occasions that’s ok, but most of the time you want something in there. The reason is that usually you want to synchronize with <em>something</em> in your code, not just perform the effect once. For example, what if our pokemon component depended on a route parameter or props, anything that said, “go get a new pokemon” without mounting/unmounting?</p>
<p>Let’s say our component depended on a prop <code>pokemonToGet</code> that was an argument telling it which pokemon to get from the API. Let’s also add a tiny form for testing purposes:</p>
<div style="margin-bottom:3rem"><pre style="margin:0;font-size:0.75rem;line-height:1.125rem;color:var(--grayLight);white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word">Live<!-- --> <!-- -->JSX<!-- --> Snippet:</pre><pre class="prism-code language-jsx" style="background-color:#282c34;color:#ffffff;overflow-x:auto;padding:10px;font-size:0.8rem;line-height:inherit"><div class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#79b6f2">Pokemon</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token parameter punctuation" style="color:#8dc891">{</span><span class="token parameter">pokemonToGet</span><span class="token parameter punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain">pokemon</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> setPokemon</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useState</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword null nil" style="color:#c5a5c5">null</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useEffect</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token function" style="color:#79b6f2">fetch</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token template-string template-punctuation string" style="color:#8dc891">`</span><span class="token template-string string" style="color:#8dc891">https://pokeapi.co/api/v2/pokemon/</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#8dc891">${</span><span class="token template-string interpolation">pokemonToGet</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#8dc891">}</span><span class="token template-string string" style="color:#8dc891">/</span><span class="token template-string template-punctuation string" style="color:#8dc891">`</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">then</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token parameter">res</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> res</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">json</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">then</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token parameter">res</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token function" style="color:#79b6f2">setPokemon</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">res</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain">pokemonToGet</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token comment" style="color:#999999">// get a new pokemon with the pokemonToGet prop changes</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> style </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token literal-property property" style="color:#5a9bcf">textTransform</span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;capitalize&#x27;</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">        </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"> pokemon</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token operator" style="color:#d7deea">?</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">                </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">img</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">src</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#8dc891">=</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">{</span><span class="token tag script language-javascript" style="color:#fc929e">pokemon</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">.</span><span class="token tag script language-javascript property-access" style="color:#fc929e">sprites</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">.</span><span class="token tag script language-javascript property-access" style="color:#fc929e">front_default</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">}</span><span class="token tag" style="color:#fc929e"></span></div><div class="token-line" style="color:#ffffff"><span class="token tag" style="color:#fc929e">                    </span><span class="token tag attr-name" style="color:#c5a5c5">alt</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#8dc891">=</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">{</span><span class="token tag script language-javascript string" style="color:#8dc891">&#x27;Image of &#x27;</span><span class="token tag script language-javascript" style="color:#fc929e"> </span><span class="token tag script language-javascript operator" style="color:#d7deea">+</span><span class="token tag script language-javascript" style="color:#fc929e"> pokemon</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">.</span><span class="token tag script language-javascript property-access" style="color:#fc929e">name</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">/&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">                </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">style</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#8dc891">=</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">{</span><span class="token tag script language-javascript" style="color:#fc929e">style</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text">Name: </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">pokemon</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">                </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">style</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#8dc891">=</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">{</span><span class="token tag script language-javascript" style="color:#fc929e">style</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">                    Type: </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">pokemon</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">types</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">map</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token parameter">x</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> x</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">type</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">join</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&#x27;, &#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">                </span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;Loading...&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#79b6f2">PokemonForm</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain">inputValue</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> setInputValue</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useState</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;rowlet&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain">pokemonToGet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> setPokemonToGet</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useState</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;gengar&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">getPokemon</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token function" style="color:#79b6f2">setPokemonToGet</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">inputValue</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">trim</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">toLowerCase</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token function" style="color:#79b6f2">setInputValue</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">input</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">onChange</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#8dc891">=</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">{</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">(</span><span class="token tag script language-javascript parameter" style="color:#fc929e">e</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">)</span><span class="token tag script language-javascript" style="color:#fc929e"> </span><span class="token tag script language-javascript arrow operator" style="color:#d7deea">=&gt;</span><span class="token tag script language-javascript" style="color:#fc929e"> </span><span class="token tag script language-javascript function" style="color:#79b6f2">setInputValue</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">(</span><span class="token tag script language-javascript" style="color:#fc929e">e</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">.</span><span class="token tag script language-javascript property-access" style="color:#fc929e">target</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">.</span><span class="token tag script language-javascript property-access" style="color:#fc929e">value</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">)</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">}</span><span class="token tag" style="color:#fc929e"></span></div><div class="token-line" style="color:#ffffff"><span class="token tag" style="color:#fc929e">                </span><span class="token tag attr-name" style="color:#c5a5c5">value</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#8dc891">=</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">{</span><span class="token tag script language-javascript" style="color:#fc929e">inputValue</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">}</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#8dc891">=</span><span class="token tag attr-value punctuation" style="color:#8dc891">&quot;</span><span class="token tag attr-value" style="color:#8dc891">text</span><span class="token tag attr-value punctuation" style="color:#8dc891">&quot;</span><span class="token tag punctuation" style="color:#8dc891">/&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">button</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#8dc891">=</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">{</span><span class="token tag script language-javascript" style="color:#fc929e">getPokemon</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">                Get Pokemon</span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">button</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag class-name" style="color:#FAC863">Pokemon</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">pokemonToGet</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#8dc891">=</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">{</span><span class="token tag script language-javascript" style="color:#fc929e">pokemonToGet</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">}</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag punctuation" style="color:#8dc891">/&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token function" style="color:#79b6f2">render</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag class-name" style="color:#FAC863">PokemonForm</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag punctuation" style="color:#8dc891">/&gt;</span><span class="token punctuation" style="color:#8dc891">)</span></div></pre></div>
<p>Great, now our component fetches a new pokemon based on our prop changes. With classes we would’ve had to play with <code>componentDidUpdate</code> and such to achieve a similar effect.</p>
<p>Ryan Florence has a great <a href="https://twitter.com/ryanflorence/status/1125041041063665666?lang=en">tweet</a> to summarize <code>useEffect</code>’s usage:</p>
<blockquote>
<p>The question is not “when does this effect run” the question is “with which state does this effect synchronize with”</p>
</blockquote>
<blockquote>
<p>useEffect(fn) // all state</p>
</blockquote>
<blockquote>
<p>useEffect(fn, []) // no state</p>
</blockquote>
<blockquote>
<p>useEffect(fn, [these, states])</p>
</blockquote>
<p>That “all state” case he mentions where you pass in nothing for dependencies is a weird one. I’ve personally never found a use for it. We know that the whole component runs with each render, so I’m wondering if there’s some weird edge case that requires you to use <code>useEffect(fn)</code> without any dependency array. In any case, most of the time you’re going to be working with this: <code>useEffect(fn, [these, states])</code>.</p>
<h2>UseEffect and Previous State: Where things fall apart</h2>
<p>The mental model so far for <code>useEffect</code> seems straight-forward enough: synchronize it with certain state changes of your choosing. The problem is when you need to reference that state in an effect, not just know if it changed.</p>
<p><strong>You don’t get access to current state inside of <code>useEffect</code>.</strong></p>
<p>We didn’t see this in our API call example because we’re simply overwriting the previous state.</p>
<p>Let’s look at a simple example:</p>
<div style="margin-bottom:3rem"><pre style="margin:0;font-size:0.75rem;line-height:1.125rem;color:var(--grayLight);white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word">Live<!-- -->, editable<!-- --> <!-- -->JSX<!-- --> Snippet:</pre><pre class="prism-code language-jsx" style="background-color:#282c34;color:#ffffff;overflow-x:auto;padding:10px;font-size:0.8rem;line-height:inherit"><div class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#79b6f2">Timer</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain">count</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> setCount</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useState</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">0</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useEffect</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> intervalId </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">setInterval</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token function" style="color:#79b6f2">setCount</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">count </span><span class="token operator" style="color:#d7deea">+</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">1</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">1000</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">clearInterval</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">intervalId</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text">The count is: </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">count</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span></div></pre></div>
<p>Seems like we did all the right things (even cleaning up our side effect on unmount) but our counter isn’t incrementing. Is it a <code>this</code> issue? Do we not have access to the <code>window</code> object that <code>setInterval</code> belongs to?</p>
<p>No and no. If you added a <code>console.log</code> into that interval, you’d see it tick every second.</p>
<p>I’ll prove it to you:</p>
<div style="margin-bottom:3rem"><pre style="margin:0;font-size:0.75rem;line-height:1.125rem;color:var(--grayLight);white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word">Live<!-- -->, editable<!-- --> <!-- -->JSX<!-- --> Snippet:</pre><pre class="prism-code language-jsx" style="background-color:#282c34;color:#ffffff;overflow-x:auto;padding:10px;font-size:0.8rem;line-height:inherit"><div class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#79b6f2">Timer</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain">count</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> setCount</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useState</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">0</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain">randomNum</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> setRandomNum</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useState</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">0</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useEffect</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> intervalId </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">setInterval</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token function" style="color:#79b6f2">setCount</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">count </span><span class="token operator" style="color:#d7deea">+</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">1</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token function" style="color:#79b6f2">setRandomNum</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token known-class-name class-name" style="color:#FAC863">Math</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">random</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">1000</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">clearInterval</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">intervalId</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text">The count is: </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">count</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text">RandomNum is </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">randomNum</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span></div></pre></div>
<p>Notice we get a new random number every second. Our interval code is fine.</p>
<p>We’re able to set new state, but are unable to access current state.</p>
<p>This is a ”<strong>stale closure</strong>”. I won’t get into closures, but just know that because of the implementation of React/hooks, the count variable is always going to be 0 in our interval function. It’s an old reference.</p>
<p><strong>Update 9/7/19</strong>: It turns out, there’s a solution for simple examples like above, as pointed out by John Tucker (thanks John!). Much like <code>setState</code> in class-based components, <code>useState</code> can also accept a callback function that receives the previous state as an argument. The <a href="https://reactjs.org/docs/hooks-reference.html#functional-updates">React Docs</a> also make note of this.</p>
<p>Here’s an example of the quick fix:</p>
<div style="margin-bottom:3rem"><pre style="margin:0;font-size:0.75rem;line-height:1.125rem;color:var(--grayLight);white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word">Live<!-- -->, editable<!-- --> <!-- -->JSX<!-- --> Snippet:</pre><pre class="prism-code language-jsx" style="background-color:#282c34;color:#ffffff;overflow-x:auto;padding:10px;font-size:0.8rem;line-height:inherit"><div class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#79b6f2">Timer</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain">count</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> setCount</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useState</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">0</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useEffect</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> intervalId </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">setInterval</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token comment" style="color:#999999">//let&#x27;s pass a function instead</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token comment" style="color:#999999">//the argument is the current state</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token function" style="color:#79b6f2">setCount</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token parameter">count</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> count </span><span class="token operator" style="color:#d7deea">+</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">1</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">1000</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">clearInterval</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">intervalId</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text">The count is: </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">count</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span></div></pre></div>
<p>This still doesn’t solve all of our problems, though. If you need to access to the latest state inside <code>useEffect</code>, but <em>not</em> update it, you would have to start wrapping your <code>useEffect</code> code in <code>setState</code> callbacks, and then returning the unchanged state at the end. This could quickly become an absolute mess, particularly if you’re working with multiple state values.</p>
<p>Another possible solution could be to work only with <code>useReducer</code>, as that receives previous state, but filling your reducer with side effects also seems very messy, and I wouldn’t suggest anyone stop using <code>useState</code> entirely.</p>
<p>In any case, I’ve fallen into the stale closure trap many, many times when writing hooks. I didn’t even know it had a name until I read it in <a href="https://docs.google.com/presentation/d/1PUvpXMBEDS45rd0wHu6tF3j_8wmGC6cOLtOw2hzU-mw/edit#slide=id.p">this talk</a> by Rich Harris, the man behind <a href="https://svelte.dev/">Svelte</a>.</p>
<p>Apparently, I’m not the only one tripping over them in hooks, either:</p>
<div><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/blog/static/5a5dbcc6667a5da9eeabc5cbe90a1427/f213e/staleclosures.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 52.70270270270271%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABg0lEQVQoz42SW66bMBCG2WQfuoGupV1Ct3HW0LequTcNkITEFLA940sABwLYVAb1tFXzcD5Z9njG/1j+5eDzp4+LxSo+HsMw2mw2lAHKGwh1K+vKmFtlxmdY56y1wYd3778tloyxy+UKAM5nnXV/+F/5mg+aR29MTRlDFACQZXmW5UJIzoExXhQFISTz5JSyLMu01q9dAuucMQYRpVTTkIhCaY0otNZKKUQUQgohtda+KoRUqm0fk9g6DrBYLqMo3u9/rNab3fd9GEXb7S6K4jCKjqdTVZZKaa1vSikx0batFw+Df3pt2qbxzarazMGj63VZ3ZvWjWPX909tC5TEpmnKsnLj6MaxH6ydzLDWDsPg/XNuDv7G+lMu2H15ySk/HEJT18aY314+x9p/xRLyR9eJ+8DqDu9958a3E3xdbsMoXh3O65hsT+n6cCQkTZLkSkia/jyfE0LIOfHzlL9c522a+ptpUQgpgXMEroQAzgGQMcY5B0TGOADQeYGpCEApnb/TL5rIa9+Khcj2AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Photo of Tweet by Kent Dodds asking about hooks pitfalls and a snarky response of &quot;stale closures&quot;"
        title="Photo of Tweet by Kent Dodds asking about hooks pitfalls and a snarky response of &quot;stale closures&quot;"
        src="/blog/static/5a5dbcc6667a5da9eeabc5cbe90a1427/fcda8/staleclosures.png"
        srcset="/blog/static/5a5dbcc6667a5da9eeabc5cbe90a1427/12f09/staleclosures.png 148w,
/blog/static/5a5dbcc6667a5da9eeabc5cbe90a1427/e4a3f/staleclosures.png 295w,
/blog/static/5a5dbcc6667a5da9eeabc5cbe90a1427/fcda8/staleclosures.png 590w,
/blog/static/5a5dbcc6667a5da9eeabc5cbe90a1427/efc66/staleclosures.png 885w,
/blog/static/5a5dbcc6667a5da9eeabc5cbe90a1427/c83ae/staleclosures.png 1180w,
/blog/static/5a5dbcc6667a5da9eeabc5cbe90a1427/f213e/staleclosures.png 1192w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></div>
<p>React even mentions it in their <a href="https://reactjs.org/docs/hooks-faq.html#why-am-i-seeing-stale-props-or-state-inside-my-function">docs</a>:</p>
<blockquote>
<p>“Any function inside a component, including event handlers and effects, “sees” the props and state from the render it was created in.”</p>
</blockquote>
<p>I read this prior and it made little sense to me before really digging into the issue. I imagine it could be a bit of a black eye for React, so perhaps they don’t wish to call it out too loudly.</p>
<p>Dan Abramov, however, describes the problem better in his <a href="https://overreacted.io/a-complete-guide-to-useeffect/">blog</a> and even provides a solution:</p>
<blockquote>
<p>“Effects always “see” props and state from the render they were defined in. That helps prevent bugs but in some cases can be annoying. For those cases, you can explicitly maintain some value in a mutable ref.”</p>
</blockquote>
<p>This was helpful, because it provided a solution in the form of <code>useRef</code> (Thanks Dan!), but it left me in the dark as to how it would help avoid the issue (mostly because I didn’t understand <code>useRef</code>).</p>
<h2>What is a “ref”, and how do you use one?</h2>
<p>So traditionally, refs were meant to let you directly access an html element. For instance, let’s say you needed to focus an input field. You have to bail out of React and use regular JavaScript to call <code>.focus()</code>. Hooks actually make this fairly simple:</p>
<div style="margin-bottom:3rem"><pre style="margin:0;font-size:0.75rem;line-height:1.125rem;color:var(--grayLight);white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word">Live<!-- -->, editable<!-- --> <!-- -->JSX<!-- --> Snippet:</pre><pre class="prism-code language-jsx" style="background-color:#282c34;color:#ffffff;overflow-x:auto;padding:10px;font-size:0.8rem;line-height:inherit"><div class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#79b6f2">InputField</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> inputRef </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useRef</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">input</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#8dc891">=</span><span class="token tag attr-value punctuation" style="color:#8dc891">&quot;</span><span class="token tag attr-value" style="color:#8dc891">text</span><span class="token tag attr-value punctuation" style="color:#8dc891">&quot;</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">ref</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#8dc891">=</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">{</span><span class="token tag script language-javascript" style="color:#fc929e">inputRef</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">}</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag punctuation" style="color:#8dc891">/&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">button</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#8dc891">=</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">{</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">(</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">)</span><span class="token tag script language-javascript" style="color:#fc929e"> </span><span class="token tag script language-javascript arrow operator" style="color:#d7deea">=&gt;</span><span class="token tag script language-javascript" style="color:#fc929e"> inputRef</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">.</span><span class="token tag script language-javascript property-access" style="color:#fc929e">current</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">.</span><span class="token tag script language-javascript method function property-access" style="color:#79b6f2">focus</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">(</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">)</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">                Click to Focus the input</span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">button</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span></div></pre></div>
<p>Great! Refs are an easy escape hatch to access native DOM APIs when we need to.</p>
<p>…but how does that help us fix our stale closure counter example?</p>
<h2>Using Refs to avoid Stale Closures</h2>
<p>The <a href="https://reactjs.org/docs/hooks-faq.html#is-there-something-like-instance-variables">React docs</a> compare refs to “instance variables”. I didn’t know what that meant (thanks <a href="https://en.wikipedia.org/wiki/Instance_variable">Wikipedia</a>), so I didn’t find that helpful.</p>
<p>I managed to wrap my head around refs by thinking about them this way:</p>
<p><strong>Refs exist outside of the re-render cycle.</strong></p>
<p>Think of refs as a variable you’re setting to the side. When your component re-runs it happily skips over that ref until you call it somewhere with <code>.current</code>.</p>
<p>Let’s see the fix for our timer example:</p>
<div style="margin-bottom:3rem"><pre style="margin:0;font-size:0.75rem;line-height:1.125rem;color:var(--grayLight);white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word">Live<!-- -->, editable<!-- --> <!-- -->JSX<!-- --> Snippet:</pre><pre class="prism-code language-jsx" style="background-color:#282c34;color:#ffffff;overflow-x:auto;padding:10px;font-size:0.8rem;line-height:inherit"><div class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#79b6f2">Timer</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain">count</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> setCount</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useState</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">0</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> countRef </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useRef</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">0</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useEffect</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> intervalId </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">setInterval</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">            countRef</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">current</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> countRef</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">current</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">+</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">1</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token function" style="color:#79b6f2">setCount</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">countRef</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">current</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">1000</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">clearInterval</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">intervalId</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text">The count is: </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">count</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span></div></pre></div>
<p>If we wanted to stop the timer at say, 10, we could easily do so using the ref:</p>
<div style="margin-bottom:3rem"><pre style="margin:0;font-size:0.75rem;line-height:1.125rem;color:var(--grayLight);white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word">Live<!-- -->, editable<!-- --> <!-- -->JSX<!-- --> Snippet:</pre><pre class="prism-code language-jsx" style="background-color:#282c34;color:#ffffff;overflow-x:auto;padding:10px;font-size:0.8rem;line-height:inherit"><div class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#79b6f2">Timer</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain">count</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> setCount</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useState</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">0</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> countRef </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useRef</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">0</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useEffect</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> intervalId </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">setInterval</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token keyword control-flow" style="color:#c5a5c5">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">countRef</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">current</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">===</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">10</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">clearInterval</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">intervalId</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">            countRef</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">current</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> countRef</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">current</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">+</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">1</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token function" style="color:#79b6f2">setCount</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">countRef</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">current</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">1000</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">clearInterval</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">intervalId</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text">The count is: </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">count</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span></div></pre></div>
<p>Here’s the alternative using the <code>setState</code> callback approach, for sake of comparison:</p>
<div style="margin-bottom:3rem"><pre style="margin:0;font-size:0.75rem;line-height:1.125rem;color:var(--grayLight);white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word">Live<!-- -->, editable<!-- --> <!-- -->JSX<!-- --> Snippet:</pre><pre class="prism-code language-jsx" style="background-color:#282c34;color:#ffffff;overflow-x:auto;padding:10px;font-size:0.8rem;line-height:inherit"><div class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#79b6f2">Timer</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain">count</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> setCount</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useState</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">0</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useEffect</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> intervalId </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">setInterval</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token function" style="color:#79b6f2">setCount</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token parameter">count</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token keyword control-flow" style="color:#c5a5c5">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">count </span><span class="token operator" style="color:#d7deea">===</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">10</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">                    </span><span class="token function" style="color:#79b6f2">clearInterval</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">intervalId</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">                    </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> count</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token keyword control-flow" style="color:#c5a5c5">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> count </span><span class="token operator" style="color:#d7deea">+</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">1</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">1000</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">clearInterval</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">intervalId</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text">The count is: </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">count</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span></div></pre></div>
<p>I could see this quickly approaching callback hell, so I would caution against using the callback approach if you’re doing something more complex.</p>
<h2>State Versus Refs</h2>
<p>Is it possible to ditch state entirely and just use refs?</p>
<p>You might be inclined to think you could use refs instead of state for your component and just sidestep all this weird behavior.</p>
<p>You can’t. <strong>Refs aren’t reactive.</strong> When you change a ref, it doesn’t cause a re-render. (Remember, they exist outside of the re-render cycle).</p>
<p>This won’t work:</p>
<div style="margin-bottom:3rem"><pre style="margin:0;font-size:0.75rem;line-height:1.125rem;color:var(--grayLight);white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word">Live<!-- -->, editable<!-- --> <!-- -->JSX<!-- --> Snippet:</pre><pre class="prism-code language-jsx" style="background-color:#282c34;color:#ffffff;overflow-x:auto;padding:10px;font-size:0.8rem;line-height:inherit"><div class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#79b6f2">Timer</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> count </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useRef</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">0</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useEffect</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> intervalId </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">setInterval</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">            count</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">current</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> count</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">current</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">+</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">1</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token comment" style="color:#999999">//console.log(&#x27;Ref example count: &#x27; + count.current)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">1000</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">clearInterval</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">intervalId</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text">The count is: </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">count</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">current</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span></div></pre></div>
<p>That component is actually counting upwards internally, but it’s not causing the HTML to update. You need <code>useState</code> for that. (Go ahead and uncomment the <code>console.log</code> if you don’t believe me)</p>
<p>Here’s an example to demonstrate refs vs state:</p>
<div style="margin-bottom:3rem"><pre style="margin:0;font-size:0.75rem;line-height:1.125rem;color:var(--grayLight);white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word">Live<!-- -->, editable<!-- --> <!-- -->JSX<!-- --> Snippet:</pre><pre class="prism-code language-jsx" style="background-color:#282c34;color:#ffffff;overflow-x:auto;padding:10px;font-size:0.8rem;line-height:inherit"><div class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#79b6f2">Counter</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain">count</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> setCount</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useState</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">0</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> countRef </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">useRef</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">0</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text">State Count: </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">count</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">button</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#8dc891">=</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">{</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">(</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">)</span><span class="token tag script language-javascript" style="color:#fc929e"> </span><span class="token tag script language-javascript arrow operator" style="color:#d7deea">=&gt;</span><span class="token tag script language-javascript" style="color:#fc929e"> </span><span class="token tag script language-javascript function" style="color:#79b6f2">setCount</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">(</span><span class="token tag script language-javascript" style="color:#fc929e">count </span><span class="token tag script language-javascript operator" style="color:#d7deea">+</span><span class="token tag script language-javascript" style="color:#fc929e"> </span><span class="token tag script language-javascript number" style="color:#5a9bcf">1</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">)</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">        Increment State Count</span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">button</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text">Ref Count: </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">countRef</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">current</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">button</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#8dc891">=</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">{</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">(</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">)</span><span class="token tag script language-javascript" style="color:#fc929e"> </span><span class="token tag script language-javascript arrow operator" style="color:#d7deea">=&gt;</span><span class="token tag script language-javascript" style="color:#fc929e"> countRef</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">.</span><span class="token tag script language-javascript property-access" style="color:#fc929e">current</span><span class="token tag script language-javascript" style="color:#fc929e"> </span><span class="token tag script language-javascript operator" style="color:#d7deea">=</span><span class="token tag script language-javascript" style="color:#fc929e"> countRef</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">.</span><span class="token tag script language-javascript property-access" style="color:#fc929e">current</span><span class="token tag script language-javascript" style="color:#fc929e"> </span><span class="token tag script language-javascript operator" style="color:#d7deea">+</span><span class="token tag script language-javascript" style="color:#fc929e"> </span><span class="token tag script language-javascript number" style="color:#5a9bcf">1</span><span class="token tag script language-javascript punctuation" style="color:#8dc891">}</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">        Increment Ref Count</span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">button</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token function" style="color:#79b6f2">render</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag class-name" style="color:#FAC863">Counter</span><span class="token tag punctuation" style="color:#8dc891">/&gt;</span><span class="token punctuation" style="color:#8dc891">)</span></div></pre></div>
<p>You won’t see the ref count change until you trigger a re-render by setting state.</p>
<h2>Parting Thoughts</h2>
<p>I love hooks and functional components in React, but the quirks I’ve outlined have given me pause. I don’t like being required to know so much about the inner-workings of React to use it. I think it presents a roadblock for those learning React, and I hope in the future the React team comes up with some better ways to handle these quirks.</p><hr style="margin-bottom:1.5rem"/><div style="margin-bottom:3.75rem"><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:80px;height:80px;margin-right:0.75rem;margin-bottom:0;min-width:80px;border-radius:100%;float:left"><img aria-hidden="true" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAME/8QAFwEBAQEBAAAAAAAAAAAAAAAAAgMAAf/aAAwDAQACEAMQAAABkvAUyLOmuUod4x//xAAbEAACAgMBAAAAAAAAAAAAAAABAgMhERMiMf/aAAgBAQABBQJx3wC9PPkSIw2TIdslj0pa/wD/xAAYEQACAwAAAAAAAAAAAAAAAAAAARARMf/aAAgBAwEBPwFYXP8A/8QAFhEAAwAAAAAAAAAAAAAAAAAAABAR/9oACAECAQE/ASP/xAAdEAACAgIDAQAAAAAAAAAAAAABEQACEBIhMVJh/9oACAEBAAY/AqPzzAatyw+xjrVQbNSyDwMf/8QAGhABAAMBAQEAAAAAAAAAAAAAAQARITFBcf/aAAgBAQABPyHGtWqThJbvpL7mL2AfALSkqzNIhlC9CNK5brfsT0Z//9oADAMBAAIAAwAAABDU2L//xAAXEQEBAQEAAAAAAAAAAAAAAAABEBEx/9oACAEDAQE/EEag4z//xAAXEQEBAQEAAAAAAAAAAAAAAAABEBFR/9oACAECAQE/EEdjk//EAB4QAQADAAICAwAAAAAAAAAAAAEAESFBUTFhcYGh/9oACAEBAAE/EHHbAy05ilaQy2zSNxJF9h3MZnFt+olrQHq0PyXRICEYQpBRQ5s8ShJJoHT4hRSrMyf/2Q==" alt="Lee Warrick" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/blog/static/dbf37cd74f542721ca6dd973938d0a48/2b9ee/profile-pic.jpg 1x,
/blog/static/dbf37cd74f542721ca6dd973938d0a48/76539/profile-pic.jpg 1.5x" /><img loading="lazy" width="80" height="80" srcset="/blog/static/dbf37cd74f542721ca6dd973938d0a48/2b9ee/profile-pic.jpg 1x,
/blog/static/dbf37cd74f542721ca6dd973938d0a48/76539/profile-pic.jpg 1.5x" src="/blog/static/dbf37cd74f542721ca6dd973938d0a48/2b9ee/profile-pic.jpg" alt="Lee Warrick" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><p>Written by <a href="https://leewarrick.com"><strong>Lee Warrick</strong></a>, Co-host of the <a href="https://techjr.dev">Tech Jr Podcast</a>, Front-end Developer, Guitarist, and Gamer.  <a href="https://tinyletter.com/leewarrick"><strong>Subscribe</strong></a> to my newsletter! Show your support by buying some <a href="https://teespring.com/stores/tech-jr-store"><strong>SWAG.</strong></a></p></div><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/blog/staying-sane-with-css/"> ← <!-- -->Staying Sane while Organizing CSS</a></li><li><a rel="next" href="/blog/a-guide-to-usestate-and-usereducer/">Bridging the Gap between React&#x27;s useState, useReducer, and Redux<!-- --> →</a></li></ul><footer style="display:flex;justify-content:space-between;flex-wrap:wrap"><span style="margin-bottom:10px">© <!-- -->2022<!-- -->, Built with  <a href="https://www.gatsbyjs.org">Gatsby</a>,  <a href="https://www.youtube.com/watch?v=HEXWRTEbj1I">Love</a>, and <a href="https://cameronsworld.net">Inter-webs</a>.   ...<a href="https://teespring.com/stores/tech-jr-store">Buy somethin&#x27;, will ya?</a></span><span><a href="/blog/">Home</a></span></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-144549907-2', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/react-use-effect-explained/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-6020e0b2a6d37690d2d6.js\"],\"component---cache-caches-gatsby-plugin-offline-app-shell-js\":[\"/component---cache-caches-gatsby-plugin-offline-app-shell-js-819fe14f87f7d11ff78a.js\"],\"component---src-pages-404-js\":[\"/component---src-pages-404-js-eb39d3d885ac4708971a.js\"],\"component---src-pages-index-js\":[\"/component---src-pages-index-js-33deb01ef95efcac0306.js\"],\"component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-a-guide-to-usestate-and-usereducer-index-md\":[\"/component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-a-guide-to-usestate-and-usereducer-index-md-8d882b0c839ac629db41.js\"],\"component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-all-i-know-about-podcasting-index-md\":[\"/component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-all-i-know-about-podcasting-index-md-9bb9d77f6574a3c3eb02.js\"],\"component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-angular-vs-react-vs-vue-index-md\":[\"/component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-angular-vs-react-vs-vue-index-md-acef06ce55bbaad8b48f.js\"],\"component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-bad-habits-successful-dev-index-md\":[\"/component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-bad-habits-successful-dev-index-md-317cb8c9805cdd4005a3.js\"],\"component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-chmod-and-permissions-index-md\":[\"/component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-chmod-and-permissions-index-md-a307ae8f403c970b64d1.js\"],\"component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-css-only-menus-index-md\":[\"/component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-css-only-menus-index-md-493290811e46cd6fd035.js\"],\"component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-debugging-javascript-index-md\":[\"/component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-debugging-javascript-index-md-f42c3e9b62619327b6cf.js\"],\"component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-how-to-debounce-index-md\":[\"/component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-how-to-debounce-index-md-81b8f5bf9c92b576d513.js\"],\"component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-how-to-learn-anything-index-md\":[\"/component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-how-to-learn-anything-index-md-00caffd55323d88e3041.js\"],\"component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-learning-machine-learning-index-md\":[\"/component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-learning-machine-learning-index-md-1b16cfff788af33ab2fb.js\"],\"component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-react-use-effect-explained-index-md\":[\"/component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-react-use-effect-explained-index-md-7d92b6c871133e9967dd.js\"],\"component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-staying-sane-with-css-index-md\":[\"/component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-staying-sane-with-css-index-md-6dd52f5c705cb0a21ac2.js\"],\"component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-the-courage-to-code-index-md\":[\"/component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-the-courage-to-code-index-md-043c9f754e705161fda9.js\"],\"component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-the-problem-with-context-index-md\":[\"/component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-the-problem-with-context-index-md-eac6f60d4f8292a1696d.js\"],\"component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-what-is-jamstack-index-md\":[\"/component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-what-is-jamstack-index-md-469fcfe3917ce6be80ae.js\"],\"component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-why-write-tests-index-md\":[\"/component---src-templates-blog-post-js-content-file-path-home-lee-dev-side-projects-blog-content-blog-why-write-tests-index-md-5b577ef9558f98547007.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="1b7ea28684f3b0331714";</script><script src="/blog/webpack-runtime-90f85e3de9726af2d10b.js" async></script><script src="/blog/framework-9649dcfd1ddbf692b0b9.js" async></script><script src="/blog/app-6020e0b2a6d37690d2d6.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>